# Lec7: 存储器层次结构
## 存储器概述
### 基本术语
- 记忆单元/存储元（Cell）：具有两种稳态的能够表示二进制数码0和1的物理器件
- 存储单元（Addressing Unit）：具有相同地址的位构成一个存储单元，也称为一个编址单位
- 存储体/ 存储矩阵/ 存储阵列（Bank）：**所有存储单元**构成一个存储阵列
- 编址方式（Addressing Mode）：按字节编址、按字编址
- 存储器地址寄存器（Memory Address Register -MAR）：用于存放**主存单元地址**的寄存器
- 存储器数据寄存器（Memory Data Register-MDR）：用于存放主存单元中的**数据**的寄存器

### 存储器分类
（1）按工作性质/存取方式分类
- 随机存取存储器 RandomAccessMemory(RAM)
按地址访问，每个单元的读写时间一样且与单元所在位置无关，比如内存

- 顺序存取存储器 SequentialAccess Memory(SAM)
数据按顺序从存储载体的始端读入或写出，存取时间的长短与信息所在位置有关，比如磁带

- 直接存取存储器 DirectAccessMemory(DAM)
直接定位到读写数据块，在读写数据块时按顺序进行。如磁盘。

- 相联存储器 AssociateMemory(AM)，Content Addressed Memory (CAM)
按内容检索到存储位置进行读写。例如：快表

（2）按存储介质分类
半导体存储器：双极型，静态MOS型，动态MOS型
磁表面存储器：磁盘（Disk）、磁带（Tape）
光存储器：CD，CD-ROM，DVD

（3）按信息的可更改性分类
读写存储器（Read / Write Memory）：可读可写
只读存储器（Read Only Memory）：只能读不能写

（4）按断电后信息的可保存性分类
非易失（不挥发）性存储器(Nonvolatile Memory) 
信息可一直保留， 不需电源维持。
（如：ROM、磁表面存储器、光存储器等）
易失（挥发）性存储器(Volatile Memory)
电源关闭时信息自动丢失。（如：RAM、Cache等）

（5）按功能/容量/速度/所在位置分类
离CPU越近，速度越快
- 寄存器(Register)
• 封装在CPU内，用于存放当前正在执行的指令和使用的数据
• 用触发器实现，**速度快**，容量小（几kB）

- 高速缓存(Cache)
• 位于CPU内部或附近，用来存放当前要执行的局部程序段和数据
• 用SRAM实现，速度可与CPU匹配，容量小（几MB）

- 主存储器MM（Main(Primary) Memory）
• 位于CPU之外，用来存放已被启动的程序及所用的数据
• 用DRAM实现，速度较快，容量较大（几GB）

- 外存储器AM(辅助存储器Auxiliary/Secondary Storage)
• 位于主机之外，用来存放暂不运行的程序、数据或存档文件
• 用磁表面或光存储器实现，容量大而速度慢

### 内存和外存关系及比较
![1763015341642](image/lec7/1763015341642.png)

### 主存
主存中主要存放指令及其数据！CPU执行指令时需要取指令、取数据、存数据，这个时候会访问主存。
![1763015439856](image/lec7/1763015439856.png)
![1763015492413](image/lec7/1763015492413.png)

### 存储区层次化结构
为了缩小存储器和处理器两者之间在性能方面的差距，通常在计算机内部采用**层次化的存储器体系结构**。
![1763015524674](image/lec7/1763015524674.png)
速度越快，容量越小，越靠近CPU
CPU可以直接访问内部存储器，而外部存储器需要先被取到主存，再被CPU访问
数据一般只在**相邻层之间**复制传输，而且总是从慢速存储器复制到快速存储器。

## 半导体随机存取存储器
### 六管静态MOS管存储元件
动态还是静态：数据是否需要周期性刷新
静态RAM（SRAM）中数据保存在一对正负反馈门电路中，只要供电，数据就一直保持，不是破环性读出，也无需重写，即无需刷新！
看作带时钟的RS触发器
![1763015921466](image/lec7/1763015921466.png)

### 单管动态MOS管存储元件
![1763015985852](image/lec7/1763015985852.png)
通过电容的充电放电的电流来判断是0还是1
动态RAM（DRAM）中数据保存在电容器中，由于电容器有漏电现象，存储的数据会随着时间的推移而逐渐消失，因此需要周期性地刷新（读出后重新写回）。

### 两种RAM的比较
![1763016110230](image/lec7/1763016110230.png)
![1763016297859](image/lec7/1763016297859.png)

### CPU与存储器之间的通信方式
有异步和同步两种通信方式
![1763017914170](image/lec7/1763017914170.png)

### SDRAM芯片技术
SDRAM是同步存储芯片
- 每步操作都在**系统时钟控制下**进行
- 有确定的等待时间（读命令开始到数据线有效的时间, 称为CAS潜伏期）CL，例如CL=2 clks
- 连续传送（Burst）数据个数BL=1 / 2 / 4 / 8
- 多体(缓冲器)交叉存取
- 利用总线时钟上升沿与下降沿同步传送
![1763017998503](image/lec7/1763017998503.png)

### 内存条和内存条插槽
内存条：把若干片DRAM芯片焊在一小条电路板上
内存条插槽：存储器总线
内存条必须插在主板上的内存条插槽中才能使用（相同颜色插槽可以并行传输）
![1763018215331](image/lec7/1763018215331.png)

### 存储器芯片的扩展
![1763018239629](image/lec7/1763018239629.png)
有两种容量扩展方式：交叉编址和连续编址。

### DRAM芯片的扩展
